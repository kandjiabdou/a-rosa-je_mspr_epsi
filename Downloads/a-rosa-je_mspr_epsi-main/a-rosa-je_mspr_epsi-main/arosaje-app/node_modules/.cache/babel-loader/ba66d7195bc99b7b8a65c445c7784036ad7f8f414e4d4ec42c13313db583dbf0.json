{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { useToggleScope } from \"./toggleScope.mjs\";\nimport { computed, inject, onScopeDispose, provide, reactive, readonly, ref, watchEffect } from 'vue';\nimport { getCurrentInstance } from \"../util/index.mjs\"; // Types\nconst StackSymbol = Symbol.for('vuetify:stack');\nconst globalStack = reactive([]);\nexport function useStack(isActive, zIndex, disableGlobalStack) {\n  const vm = getCurrentInstance('useStack');\n  const createStackEntry = !disableGlobalStack;\n  const parent = inject(StackSymbol, undefined);\n  const stack = reactive({\n    activeChildren: new Set()\n  });\n  provide(StackSymbol, stack);\n  const _zIndex = ref(+zIndex.value);\n  useToggleScope(isActive, () => {\n    var _globalStack$at;\n    const lastZIndex = (_globalStack$at = globalStack.at(-1)) == null ? void 0 : _globalStack$at[1];\n    _zIndex.value = lastZIndex ? lastZIndex + 10 : +zIndex.value;\n    if (createStackEntry) {\n      globalStack.push([vm.uid, _zIndex.value]);\n    }\n    parent == null ? void 0 : parent.activeChildren.add(vm.uid);\n    onScopeDispose(() => {\n      if (createStackEntry) {\n        const idx = globalStack.findIndex(v => v[0] === vm.uid);\n        globalStack.splice(idx, 1);\n      }\n      parent == null ? void 0 : parent.activeChildren.delete(vm.uid);\n    });\n  });\n  const globalTop = ref(true);\n  if (createStackEntry) {\n    watchEffect(() => {\n      var _globalStack$at2;\n      const _isTop = ((_globalStack$at2 = globalStack.at(-1)) == null ? void 0 : _globalStack$at2[0]) === vm.uid;\n      setTimeout(() => globalTop.value = _isTop);\n    });\n  }\n  const localTop = computed(() => !stack.activeChildren.size);\n  return {\n    globalTop: readonly(globalTop),\n    localTop,\n    stackStyles: computed(() => ({\n      zIndex: _zIndex.value\n    }))\n  };\n}","map":{"version":3,"mappings":";SAASA,cAAc;AAEvB,SAASC,QAAQ,EAAEC,MAAM,EAAEC,cAAc,EAAEC,OAAO,EAAEC,QAAQ,EAAEC,QAAQ,EAAEC,GAAG,EAAEC,WAAW,QAAQ,KAAK;AAAA,SAC5FC,kBAAkB,6BAE3B;AAGA,MAAMC,WAAuC,GAAGC,MAAM,CAACC,GAAG,CAAC,eAAe,CAAC;AAM3E,MAAMC,WAAW,GAAGR,QAAQ,CAAkC,EAAE,CAAC;AAEjE,OAAO,SAASS,QAAQ,CACtBC,QAAgC,EAChCC,MAAsC,EACtCC,kBAA2B,EAC3B;EACA,MAAMC,EAAE,GAAGT,kBAAkB,CAAC,UAAU,CAAC;EACzC,MAAMU,gBAAgB,GAAG,CAACF,kBAAkB;EAE5C,MAAMG,MAAM,GAAGlB,MAAM,CAACQ,WAAW,EAAEW,SAAS,CAAC;EAC7C,MAAMC,KAAmB,GAAGjB,QAAQ,CAAC;IACnCkB,cAAc,EAAE,IAAIC,GAAG;EACzB,CAAC,CAAC;EACFpB,OAAO,CAACM,WAAW,EAAEY,KAAK,CAAC;EAE3B,MAAMG,OAAO,GAAGlB,GAAG,CAAC,CAACS,MAAM,CAACU,KAAK,CAAC;EAClC1B,cAAc,CAACe,QAAQ,EAAE,MAAM;IAAA;IAC7B,MAAMY,UAAU,sBAAGd,WAAW,CAACe,EAAE,CAAC,CAAC,CAAC,CAAC,qBAAlBC,gBAAqB,CAAC,CAAC;IAC1CJ,OAAO,CAACC,KAAK,GAAGC,UAAU,GAAGA,UAAU,GAAG,EAAE,GAAG,CAACX,MAAM,CAACU,KAAK;IAE5D,IAAIP,gBAAgB,EAAE;MACpBN,WAAW,CAACiB,IAAI,CAAC,CAACZ,EAAE,CAACa,GAAG,EAAEN,OAAO,CAACC,KAAK,CAAC,CAAC;IAC3C;IAEAN,MAAM,oBAANA,MAAM,CAAEG,cAAc,CAACS,GAAG,CAACd,EAAE,CAACa,GAAG,CAAC;IAElC5B,cAAc,CAAC,MAAM;MACnB,IAAIgB,gBAAgB,EAAE;QACpB,MAAMc,GAAG,GAAGpB,WAAW,CAACqB,SAAS,CAACC,CAAC,IAAIA,CAAC,CAAC,CAAC,CAAC,KAAKjB,EAAE,CAACa,GAAG,CAAC;QACvDlB,WAAW,CAACuB,MAAM,CAACH,GAAG,EAAE,CAAC,CAAC;MAC5B;MAEAb,MAAM,oBAANA,MAAM,CAAEG,cAAc,CAACc,MAAM,CAACnB,EAAE,CAACa,GAAG,CAAC;IACvC,CAAC,CAAC;EACJ,CAAC,CAAC;EAEF,MAAMO,SAAS,GAAG/B,GAAG,CAAC,IAAI,CAAC;EAC3B,IAAIY,gBAAgB,EAAE;IACpBX,WAAW,CAAC,MAAM;MAAA;MAChB,MAAM+B,MAAM,GAAG,gCAAW,CAACX,EAAE,CAAC,CAAC,CAAC,CAAC,qBAAlBY,iBAAqB,CAAC,CAAC,MAAKtB,EAAE,CAACa,GAAG;MACjDU,UAAU,CAAC,MAAMH,SAAS,CAACZ,KAAK,GAAGa,MAAM,CAAC;IAC5C,CAAC,CAAC;EACJ;EAEA,MAAMG,QAAQ,GAAGzC,QAAQ,CAAC,MAAM,CAACqB,KAAK,CAACC,cAAc,CAACoB,IAAI,CAAC;EAE3D,OAAO;IACLL,SAAS,EAAEhC,QAAQ,CAACgC,SAAS,CAAC;IAC9BI,QAAQ;IACRE,WAAW,EAAE3C,QAAQ,CAAC,OAAO;MAAEe,MAAM,EAAES,OAAO,CAACC;IAAM,CAAC,CAAC;EACzD,CAAC;AACH","names":["useToggleScope","computed","inject","onScopeDispose","provide","reactive","readonly","ref","watchEffect","getCurrentInstance","StackSymbol","Symbol","for","globalStack","useStack","isActive","zIndex","disableGlobalStack","vm","createStackEntry","parent","undefined","stack","activeChildren","Set","_zIndex","value","lastZIndex","at","_globalStack$at","push","uid","add","idx","findIndex","v","splice","delete","globalTop","_isTop","_globalStack$at2","setTimeout","localTop","size","stackStyles"],"sources":["../../src/composables/stack.ts"],"sourcesContent":["import { useToggleScope } from '@/composables/toggleScope'\n\nimport { computed, inject, onScopeDispose, provide, reactive, readonly, ref, watchEffect } from 'vue'\nimport { getCurrentInstance } from '@/util'\n\n// Types\nimport type { InjectionKey, Ref } from 'vue'\n\nconst StackSymbol: InjectionKey<StackProvide> = Symbol.for('vuetify:stack')\n\ninterface StackProvide {\n  activeChildren: Set<number>\n}\n\nconst globalStack = reactive<[uid: number, zIndex: number][]>([])\n\nexport function useStack (\n  isActive: Readonly<Ref<boolean>>,\n  zIndex: Readonly<Ref<string | number>>,\n  disableGlobalStack: boolean\n) {\n  const vm = getCurrentInstance('useStack')\n  const createStackEntry = !disableGlobalStack\n\n  const parent = inject(StackSymbol, undefined)\n  const stack: StackProvide = reactive({\n    activeChildren: new Set<number>(),\n  })\n  provide(StackSymbol, stack)\n\n  const _zIndex = ref(+zIndex.value)\n  useToggleScope(isActive, () => {\n    const lastZIndex = globalStack.at(-1)?.[1]\n    _zIndex.value = lastZIndex ? lastZIndex + 10 : +zIndex.value\n\n    if (createStackEntry) {\n      globalStack.push([vm.uid, _zIndex.value])\n    }\n\n    parent?.activeChildren.add(vm.uid)\n\n    onScopeDispose(() => {\n      if (createStackEntry) {\n        const idx = globalStack.findIndex(v => v[0] === vm.uid)\n        globalStack.splice(idx, 1)\n      }\n\n      parent?.activeChildren.delete(vm.uid)\n    })\n  })\n\n  const globalTop = ref(true)\n  if (createStackEntry) {\n    watchEffect(() => {\n      const _isTop = globalStack.at(-1)?.[0] === vm.uid\n      setTimeout(() => globalTop.value = _isTop)\n    })\n  }\n\n  const localTop = computed(() => !stack.activeChildren.size)\n\n  return {\n    globalTop: readonly(globalTop),\n    localTop,\n    stackStyles: computed(() => ({ zIndex: _zIndex.value })),\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}